Реализовать суффиксный массив.
Время построения - O(NlogN)
Реализовать с помощью него алгоритм поиска всех вхождений заданной строки в исходный текст за время O(M + logN)